{
  "batch_size": 256,
  "steps": 100000,
  "eval_freq": 5000,
  "save_freq": 1000,
  "log_freq": 1000,
  "save_checkpoint": true,
  "wandb": {
    "enable": true,
    "project": "mkrobot_hil_serl", 
    "notes": "RL", 
    "mode": "online"
  },
  "env": {
    "type": "gym_manipulator",
    "name": "real_robot",
    "fps": 15,
    "robot": {
      "type": "mk_robot",
      "port": "/dev/ttyACM0",
      "joint_velocity_scaling": 1.0,
      "cameras": {
        "wrist_camera": {
          "type": "opencv",
          "index_or_path": 2,
          "width": 640,
          "height": 360,
          "fps": 20
        },
        "side_camera": {
          "type": "opencv",
          "index_or_path": 0,
          "width": 640,
          "height": 480,
          "fps": 20
        }
      }
    },
    "teleop": {
      "type": "gamepad_ik",
      "urdf_path": "../hardware/urdf/urdf/dk2.SLDASM.urdf",
      "mesh_dir": "../hardware/urdf",
      "trans_speed": 0.002,
      "rot_speed": 0.02,
      "visualize": true,
      "inverse_kinematics": {
        "target_frame_name": "link4",
        "end_effector_bounds": {
          "min": [-0.139, -0.320, 0.227],
          "max": [0.128, -0.116, 0.309]
        }
      }
    },
    "processor": {
      "max_gripper_pos": 0.04,
      "reward_classifier": {
        "pretrained_path": "outputs/train/2025-12-16/15-35-29_reward_classifier/checkpoints/last/pretrained_model",
        "success_threshold": 0.8,
        "success_reward": 1.0
      },
      "image_preprocessing": {
        "crop_params_dict": {
          "observation.images.wrist_camera": [4, 100, 349, 425],
          "observation.images.side_camera": [35, 107, 431, 519]
        },
        "resize_size": [128, 128]
      },
      "observation": {
        "add_joint_velocity_to_observation": false,
        "add_current_to_observation": false,
        "display_cameras": true
      },
      "gripper": {
        "use_gripper": true,
        "gripper_penalty": 0.0
      },
      "reset": {
        "fixed_reset_joint_positions": [0, 0, 0, 0, 0, 0, 0.0],
        "reset_time_s": 15,
        "control_time_s": 50.0,
        "terminate_on_success": true
      }
    }
  },
  "dataset": {
    "repo_id": "mkygogo/mk_arm_hil_serl_v1",
    "root": "data_cropped_resized/",
    "image_transforms": {
      "enable": true,
      "max_num_transforms": 2,
      "random_order": true,
      "tfs": {
        "brightness": {
          "weight": 0.05,
          "type": "ColorJitter",
          "kwargs": { "brightness": [0.8, 1.2] }
        },
        "contrast": {
          "weight": 0.05,
          "type": "ColorJitter",
          "kwargs": { "contrast": [0.8, 1.2] }
        },
        "saturation": {
          "weight": 0.05,
          "type": "ColorJitter",
          "kwargs": { "saturation": [0.5, 1.5] }
        },
        "hue": {
          "weight": 0.01,
          "type": "ColorJitter",
          "kwargs": { "hue": [-0.05, 0.05] }
        },
        "affine": {
          "weight": 1.0,
          "type": "RandomAffine",
          "kwargs": {
            "degrees": [-5.0, 5.0],
            "translate": [0.04, 0.04],
            "scale": [0.9, 1.1]
          }
        }
      }
    }
  },
  "num_workers": 0,
  "policy": {
    "push_to_hub": false,
    "device": "cuda",
    "type": "sac",
    "grad_clip_norm": 5.0,
    "target_entropy": -7.0,
    "discount": 0.99,
    "critic_target_update_weight": 0.005,
    "temperature_init": 0.1,
    "utd_ratio": 2,
    "online_step_before_learning": 5000,
    "offline_buffer_capacity": 30000,
    "online_buffer_capacity": 40000,
    "input_features": {
      "observation.images.wrist_camera": {
        "type": "VISUAL",
        "shape": [3, 128, 128]
      },
      "observation.images.side_camera": {
        "type": "VISUAL",
        "shape": [3, 128, 128]
      },
      "observation.state": {
        "type": "STATE",
        "shape": [7]
      }
    },
    "output_features": {
      "action": {
        "type": "ACTION",
        "shape": [7]
      }
    },
    "actor_learner_config": {
      "policy_parameters_push_frequency": 2
    }
  }
}